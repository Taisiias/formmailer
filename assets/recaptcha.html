<html>

<head>
    <script type='text/javascript'>
        const THANKS_PAGE = "{{{thanksPageUrl}}}";
        const DATA = {{{parsedRequestData}}};

        var onSubmit = function (token) {
            console.log('token = ' + token);
            var httpRequest = new XMLHttpRequest();

            httpRequest.onload = ajaxSuccess;

            httpRequest.open("POST", "http://localhost:3000/submit/", true);
            httpRequest.setRequestHeader('Content-Type', 'application/json');
            let data = DATA;
            data["g-recaptcha-response"] = token;
            httpRequest.send(JSON.stringify(data));
        };

        function ajaxSuccess() {
            console.log(THANKS_PAGE);
            window.location.replace(THANKS_PAGE);
        };

        window.onload = function() {
            grecaptcha.execute();
        }
    </script>
    <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</head>

<body>
    <div id='recaptcha'
        class="g-recaptcha"
        data-sitekey="{{{dataSiteKey}}}"
        data-callback="onSubmit"
        data-size="invisible">
    </div>
</body>

</html>
